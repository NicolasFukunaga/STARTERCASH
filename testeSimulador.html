<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Simulador de Investimentos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      padding: 30px;
    }

    h1 {
      margin-bottom: 10px;
    }

    .container {
      max-width: 900px;
      margin: auto;
      background: #020617;
      padding: 25px;
      border-radius: 10px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-size: 14px;
    }

    input, select, button {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: none;
      outline: none;
      font-size: 14px;
    }

    input, select {
      background: #020617;
      color: #fff;
      border: 1px solid #334155;
    }

    button {
      background: #2563eb;
      color: #fff;
      cursor: pointer;
      margin-top: 10px;
    }

    button:hover {
      background: #1d4ed8;
    }

    .assets {
      margin-top: 25px;
    }

    .asset-item {
      display: flex;
      justify-content: space-between;
      background: #020617;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 8px;
      border: 1px solid #334155;
    }

    .result {
      margin-top: 25px;
      padding: 20px;
      background: #020617;
      border-radius: 8px;
      border: 1px solid #334155;
    }

    .result p {
      margin: 5px 0;
    }
  </style>
</head>

<body>

  <div class="container">
    <h1>Simulador de Investimentos</h1>
    <p>Simulação baseada em taxas médias (mock API)</p>

    <div class="grid">
      <div>
        <label>Escolha o ativo</label>
        <select id="assetSelect"></select>
      </div>

      <div>
        <label>Valor investido (R$)</label>
        <input type="number" id="investValue" placeholder="Ex: 1000">
      </div>

      <div>
        <label>Tempo (meses)</label>
        <input type="number" id="months" placeholder="Ex: 12">
      </div>

      <div>
        <button id="addAsset">Adicionar ativo</button>
      </div>
    </div>

    <div class="assets">
      <h3>Ativos selecionados</h3>
      <div id="assetsList"></div>
    </div>

    <button id="simulate">Simular investimento</button>

    <div class="result" id="result" style="display:none;"></div>
  </div>

<script>
/* ===========================
   MOCK DE TAXAS (FUTURA API)
   =========================== */

const taxas = {
  "BTC": { nome: "Bitcoin", taxaMensal: 0.025 },
  "ETH": { nome: "Ethereum", taxaMensal: 0.021 },
  "CDI": { nome: "CDI", taxaMensal: 0.009 },
  "IPCA+": { nome: "Tesouro IPCA+", taxaMensal: 0.012 },
  "FII": { nome: "Fundo Imobiliário", taxaMensal: 0.010 }
};

/* ===========================
   ESTADO DA APLICAÇÃO
   =========================== */

const selectedAssets = [];

/* ===========================
   ELEMENTOS DOM
   =========================== */

const assetSelect = document.getElementById("assetSelect");
const investValue = document.getElementById("investValue");
const monthsInput = document.getElementById("months");
const assetsList = document.getElementById("assetsList");
const resultDiv = document.getElementById("result");

/* ===========================
   POPULAR SELECT
   =========================== */

for (const key in taxas) {
  const option = document.createElement("option");
  option.value = key;
  option.textContent = `${taxas[key].nome} (${key})`;
  assetSelect.appendChild(option);
}

/* ===========================
   ADICIONAR ATIVO
   =========================== */

document.getElementById("addAsset").addEventListener("click", () => {
  const asset = assetSelect.value;
  const value = parseFloat(investValue.value);

  if (!value || value <= 0) {
    alert("Informe um valor válido");
    return;
  }

  selectedAssets.push({
    ativo: asset,
    valor: value
  });

  investValue.value = "";
  renderAssets();
});

/* ===========================
   RENDERIZA ATIVOS
   =========================== */

function renderAssets() {
  assetsList.innerHTML = "";

  selectedAssets.forEach((item, index) => {
    const div = document.createElement("div");
    div.className = "asset-item";
    div.innerHTML = `
      <span>${taxas[item.ativo].nome} — R$ ${item.valor.toFixed(2)}</span>
      <button onclick="removeAsset(${index})">X</button>
    `;
    assetsList.appendChild(div);
  });
}

function removeAsset(index) {
  selectedAssets.splice(index, 1);
  renderAssets();
}

/* ===========================
   SIMULAÇÃO
   =========================== */

document.getElementById("simulate").addEventListener("click", () => {
  const months = parseInt(monthsInput.value);

  if (!months || months <= 0) {
    alert("Informe o tempo em meses");
    return;
  }

  let totalInvestido = 0;
  let totalFinal = 0;

  selectedAssets.forEach(item => {
    const taxa = taxas[item.ativo].taxaMensal;
    totalInvestido += item.valor;

    const montante = item.valor * Math.pow(1 + taxa, months);
    totalFinal += montante;
  });

  const lucro = totalFinal - totalInvestido;
  const rentabilidade = (lucro / totalInvestido) * 100;

  resultDiv.style.display = "block";
  resultDiv.innerHTML = `
    <h3>Resultado da simulação</h3>
    <p>Total investido: R$ ${totalInvestido.toFixed(2)}</p>
    <p>Valor final estimado: R$ ${totalFinal.toFixed(2)}</p>
    <p>Lucro: R$ ${lucro.toFixed(2)}</p>
    <p>Rentabilidade: ${rentabilidade.toFixed(2)}%</p>
  `;

  console.log("Payload pronto para enviar ao backend:");
  console.log({
    meses: months,
    ativos: selectedAssets
  });
});
</script>

</body>
</html>
